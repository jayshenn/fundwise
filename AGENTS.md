# Repository Guidelines

## Project Structure & Module Organization
Core code lives in `src/fundwise/`, split by domain modules such as `data_adapter`, `company_dossier`, `watchlist_screener`, `market_timing_panel`, `report_engine`, `storage`, and `pipeline`.
Command-line entry points are in `scripts/` (for example, `run_daily_pipeline.py`, `generate_company_report.py`).
Tests are under `tests/` and generally mirror module boundaries (`test_<module>.py`).
Reference material and design notes are in `docs/`; local metadata and runtime outputs are written under `data/` and report folders generated by scripts.

## Build, Test, and Development Commands
- `uv sync`: create/update the project virtual environment from `pyproject.toml` and `uv.lock`.
- `uv run ruff check .`: run lint checks.
- `uv run ruff format .`: format code.
- `uv run pyright`: run static type checks.
- `uv run pytest -q`: run default test suite (live AkShare tests are skipped unless enabled).
- `uv run env RUN_AKSHARE_TESTS=1 pytest -q -m akshare_live -s`: run live AkShare contract tests.
- `uv run python scripts/init_sqlite.py`: initialize the SQLite metadata DB before pipeline/report flows.

## Coding Style & Naming Conventions
Use Python 3.11+ and follow Ruff settings in `pyproject.toml` (line length 100, double quotes, import sorting enforced).
Use 4-space indentation, `snake_case` for modules/functions/variables, `PascalCase` for classes, and `UPPER_SNAKE_CASE` for constants.
Keep public functions typed where practical.
Project convention is Chinese docstrings/comments/CLI text for new code, with technical proper nouns (for example `AkShare`, `SQLite`) kept as needed.

## Testing Guidelines
Use `pytest` with files named `test_*.py` and test functions named `test_*`.
Prefer deterministic unit tests using fakes/mocks (see `_FakeAdapter` pattern in pipeline tests) and `tmp_path` for filesystem isolation.
Mark network-dependent tests with `@pytest.mark.akshare_live`; keep them out of default CI/local quick runs.
No fixed coverage gate is configured, but new features should include happy-path and error-path tests.

## Commit & Pull Request Guidelines
Current history is minimal (`Initial commit`), so adopt concise imperative commit subjects (for example, `pipeline: record partial-failure summary`) and add a body when changing data schema or report formats.
PRs should include: purpose, key files/modules changed, commands run (`ruff`, `pytest`, optionally live tests), and sample output paths/screenshots when report rendering changes.

## Security & Configuration Tips
Do not commit secrets or local environment files (`.env`, `.venv` are ignored).
Treat generated runtime artifacts (SQLite DB snapshots, daily reports, normalized data exports) as build outputs unless intentionally versioned.
